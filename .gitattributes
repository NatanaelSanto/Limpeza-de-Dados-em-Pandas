import pandas as pd
import numpy as np

#DataFrame
dados_vendas = {
    'ID_Transacao': [101, 102, 103, 104, 105, 106, 107, 108, 109, 110],
    'Livro': ['Python Básico', 'Data Science Avancada', 'Python Básico', 'Estatística Essencial',
              'Data Science Avancada', 'Web Scraping', 'Python Básico', 'Estatística Essencial',
              'Web Scraping', 'Data Science Avancada'],
    'Categoria': ['Programacao', 'Data Science', 'Programacao', 'Data Science',
                  'Data Science', 'Programacao', 'Programacao', 'Data Science',
                  'Programacao', 'Data Science'],
    'Preco_Unitario': [50.00, 99.90, 50.00, 75.50, 99.90, 45.00, 50.00, 75.50, 'np.nan', 99.90], # Um valor 'nan' (ausente)
    'Quantidade_Vendida': [2, 1, 3, 1, 2, 1, '4', 1, 2, 1], # Um valor como string '4'
    'Cliente_Avaliacao': [4.5, 4.8, 4.5, 4.2, 4.8, 3.9, 4.5, 4.2, 3.9, 'N/A'], # Um valor ausente representado como 'N/A'
    'Data_Venda': ['2023-10-01', '2023-10-01', '2023-10-02', '2023-10-02',
                   '2023-10-03', '2023-10-04', '2023-10-05', '2023-10-05',
                   '2023-10-06', '2023-10-07']
}

#Transformando os dados em DataFrame
df_vendas = pd.DataFrame(dados_vendas)
df_vendas

#Visualizando
df_vendas.info()

#Visualizando
df_vendas

df_vendas['Preco_Unitario'].replace('np.nan', 55, inplace=True)
df_vendas['Quantidade_Vendida'] = df_vendas['Quantidade_Vendida'].astype(int)
df_vendas['Quantidade_Vendida'][6]

# Substituir possíveis strings que representem valores ausentes
df_vendas = df_vendas.replace(["N/A", "n/a", "NA", "np.nan", "NaN"], np.nan)

# Converter todas as colunas numéricas corretamente
for col in df_vendas.columns:
    # Tenta converter — se não for numérica, ignora
    df_vendas[col] = pd.to_numeric(df_vendas[col], errors='ignore')

# Preencher valores ausentes (NaN) com a média das colunas numéricas
df_vendas = df_vendas.fillna(df_vendas.mean(numeric_only=True))

df_vendas['Receita_Total'] = df_vendas['Preco_Unitario'] * df_vendas['Quantidade_Vendida']
df_receita_cat = df_vendas.groupby('Categoria')['Receita_Total'].sum()

print(df_receita_cat)

df_receita_livros = df_vendas.groupby('Livro')['Quantidade_Vendida'].sum()

print(f'{df_receita_livros.sort_values(ascending=False)}')
